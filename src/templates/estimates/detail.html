{% extends "base.html" %}
{% load static %}
{% block title %}IDEAL_ASP{% endblock %}
{% block style %}
    <!-- <link rel="stylesheet" type="text/css" href="{% static 'css/constructions/detail.css' %}"> -->
    <link rel="stylesheet" type="text/css" href="{% static 'css/estimates/detail.css' %}">
{% endblock %}

{% load parse %}
{% load calc %}
{% load humanize %}

{% block content %}
<div class="wrapper">
    <div id="sideBar_wrapper" class="sideBar">
        {% include "side-bar.html" %}
    </div>
    <div class="row">
        <main class="col-md-12">
            <div class="p-6">
                {% include "documents-tab.html" %}
                <div class="tab-content">
                    <div id="tab_estimate" class="tab-pane active">
                        <form id="update-form" method="post">
                            {% csrf_token %}
                            <div id="_message-box" class="{{ alert_type }}">{{ alert_message }}</div>
                            <div id="e1">
                                <div class="wrapper_button">
                                    <button type="button" class="btn-back btn btn-outline-warning btn-md _go_back_btn"><i class="sub-icon fas fa-angle-double-left"></i>戻る</button>
                                    <button type="submit" class="btn-update btn btn-outline-warning btn-md _estimate-save-button" form="update-form" formaction="{% url 'estimates:update' estimation.id %}" formmethod="post"><i class="sub-icon fas fa-file-export"></i>保存</button>
                                    <button type="submit" class="btn btn-outline-warning btn-md _estimate-preview-btn" form="update-form" formaction="{% url 'estimates:preview' estimation.id %}" formmethod="post"><i class="sub-icon fas fa-search-plus"></i>プレビュー</button>
                                    <button class="btn btn_delete btn-outline-warning btn-md _estimate-delete-btn" value="{{estimation.id}}"><i class="sub-icon fas fa-trash-alt"></i>削除</button>
                                </div>
                                <div class="row">
                                    <div class="col-4">
                                        <div class="form_area">
                                            <table class="table table-striped table-bordered text-nowrap">
                                                <tbody>
                                                    <tr>
                                                        <th>請求先顧客名</th>
                                                        <td>
                                                            <input type="text" class="form-control" name="client_name" value="{{ estimation.client_name }}">
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th>契約者名</th>
                                                        <td>
                                                            <input type="text" class="form-control" name="contractor_name" value="{{ estimation.contractor_name }}">
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <table class="table table-striped table-bordered text-nowrap">
                                                <tbody>
                                                    <tr>
                                                        <th>ステータス</th>
                                                        <td>
                                                            <select class="form-control" id="status" name="status">
                                                                {% for estimation_status in estimation_statuses %}
                                                                    {% if estimation_status.0 == estimation.status %}
                                                                        <option value="{{ estimation_status.0 }}" selected>{{ estimation_status.1 }}</option>
                                                                    {% else %}
                                                                        <option value="{{ estimation_status.0 }}">{{ estimation_status.1 }}</option>
                                                                    {% endif %}
                                                                {% endfor %}
                                                            </select>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th>見積提出日</th>
                                                        <td><input type="text" class="form-control" name="submission_date" value="{{ estimation.submission_date|date:'Y-m-d' }}" onfocus="type='date'"></td>
                                                    </tr>
                                                    <tr>
                                                        <th>見積書番号</th>
                                                        <td>{{ estimation.code }}</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered text-nowrap">
                                                <tbody>
                                                    <tr>
                                                        <th>工事番号</th>
                                                        <td>{{ estimation.construction.code }}</td>
                                                    </tr>
                                                    <tr>
                                                        <th>工事件名</th>
                                                        <td>
                                                            <input type="text" class="form-control" name="construction_name" value="{{ estimation.construction_name }}">
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th>工事日数</th>
                                                        <td><input type="number" class="form-control" name="construction_days" value="{{ estimation.construction_days }}"></td>
                                                    </tr>
                                                    <tr>
                                                        <th>日数単価</th>
                                                        <td>{{ estimation.total | divide:estimation.construction_days | intcomma }}</td>
                                                    </tr>
                                                    <tr>
                                                        <th>営業担当</th>
                                                        <td>
                                                            <select class="form-control" id="sales_user_name" name="sales_user_name" value="{{ estimation.sales_user_name }}">
                                                            {% for user in users %}
                                                                {% if user.name == estimation.sales_user_name %}
                                                                    <option value="{{ user.name }}" selected>{{ user.name }}</option>
                                                                {% else %}
                                                                    <option value="{{ user.name }}">{{ user.name }}</option>
                                                                {% endif %}
                                                            {% endfor %}
                                                            </select>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th>積算担当</th>
                                                        <td>
                                                            <select class="form-control" id="accountant_user_name" name="accountant_user_name" value="{{ estimation.accountant_user_name }}">
                                                            {% for user in users %}
                                                                {% if user.name == estimation.accountant_user_name %}
                                                                    <option value="{{ user.name }}" selected>{{ user.name }}</option>
                                                                {% else %}
                                                                    <option value="{{ user.name }}">{{ user.name }}</option>
                                                                {% endif %}
                                                            {% endfor %}
                                                            </select>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="row">
                                            <div class="table-responsive">
                                                <table class="table table-striped table-bordered text-nowrap">
                                                    <thead>
                                                        <tr>
                                                            <th>作成者</th>
                                                            <th>作成日</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>{{ estimation.created.name }}</td>
                                                            <td>{{ estimation.created_at }}</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div class="table-responsive">
                                                <table class="table table-striped table-bordered text-nowrap">
                                                    <thead>
                                                        <tr>
                                                            <th>修正者</th>
                                                            <th>修正日</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            {% if estimation.updated_at %}
                                                                <td>{{ estimation.updated.name }}</td>
                                                                <td>{{ estimation.updated_at }}</td>
                                                            {% endif %}
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <table class="table table-striped">
                                                <tbody>
                                                    <tr>
                                                        <th>過去発行版</th>
                                                        <td>
                                                            {% for publishedfile in publishedfiles %}
                                                                <a href="{% url 'estimates:PastPdfDownload' publishedfile.id %}">{{ publishedfile.filename }}</a><br/>
                                                            {% endfor %}
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-6 offset-6">
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered text-nowrap">
                                                <thead>
                                                    <tr>
                                                        <th>検印1</th>
                                                        <th>検印2</th>
                                                        <th>検印3</th>
                                                        <!--
                                                        <th>検印4</th>
                                                        -->
                                                        <th>作成者印</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td>
                                                            <select class="form-control" id="stamp1_user_id" name="stamp1_user_id" value="{{ estimation.stamp1_user_id }}">
                                                                <option value=""></option>
                                                            {% for user in users %}
                                                                {% if user.id == estimation.stamp1_user_id %}
                                                                    <option value="{{ user.id }}" selected>{{ user.name }}</option>
                                                                {% else %}
                                                                    <option value="{{ user.id }}">{{ user.name }}</option>
                                                                {% endif %}
                                                            {% endfor %}
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select class="form-control" id="stamp2_user_id" name="stamp2_user_id" value="{{ estimation.stamp2_user_id }}">
                                                                <option value=""></option>
                                                            {% for user in users %}
                                                                {% if user.id == estimation.stamp2_user_id %}
                                                                    <option value="{{ user.id }}" selected>{{ user.name }}</option>
                                                                {% else %}
                                                                    <option value="{{ user.id }}">{{ user.name }}</option>
                                                                {% endif %}
                                                            {% endfor %}
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select class="form-control" id="stamp3_user_id" name="stamp3_user_id" value="{{ estimation.stamp3_user_id }}">
                                                                <option value="" ></option>
                                                            {% for user in users %}
                                                                {% if user.id == estimation.stamp3_user_id %}
                                                                    <option value="{{ user.id }}" selected>{{ user.name }}</option>
                                                                {% else %}
                                                                    <option value="{{ user.id }}">{{ user.name }}</option>
                                                                {% endif %}
                                                            {% endfor %}
                                                            </select>
                                                        </td>
                                                        <input type="hidden" name="stamp4_user_id" value="">
                                                        <!--
                                                        <td>
                                                            <select class="form-control" id="stamp4_user_id" name="stamp4_user_id" value="{{ estimation.stamp4_user_id }}">
                                                                <option value="" ></option>
                                                            {% for user in users %}
                                                                {% if user.id == estimation.stamp4_user_id %}
                                                                    <option value="{{ user.id }}" selected>{{ user.name }}</option>
                                                                {% else %}
                                                                    <option value="{{ user.id }}">{{ user.name }}</option>
                                                                {% endif %}
                                                            {% endfor %}
                                                            </select>
                                                        </td>
                                                        -->
                                                        <td>
                                                            <select class="form-control" id="author_stamp_user_id" name="author_stamp_user_id" value="{{ estimation.author_stamp_user_id }}">
                                                                <option value="" ></option>
                                                            {% for user in users %}
                                                                {% if user.id == estimation.author_stamp_user_id %}
                                                                    <option value="{{ user.id }}" selected>{{ user.name }}</option>
                                                                {% else %}
                                                                    <option value="{{ user.id }}">{{ user.name }}</option>
                                                                {% endif %}
                                                            {% endfor %}
                                                            </select>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-4">
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered text-nowrap">
                                                <tr>
                                                    <th>摘要</th>
                                                    <td><textarea wrap="soft" name="summary" cols="30" rows="10"　maxlength="100" value="{{ estimation.summary }}">{{ estimation.summary }}</textarea></td>
                                                </tr>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="col-4"><!-- offset-4 -->
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered text-nowrap">
                                                <thead>
                                                    <tr>
                                                        <th>内訳合計</th>
                                                        <th>消費税</th>
                                                        <th>合計金額</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <input type="hidden" id="tax_rate" name="tax_rate" value="{{ tax_rate }}">
                                                        <td><i id="estimate_total">{{ estimation.total|intcomma }}</i> 円</td>
                                                        <td><i id="estimate_tax">{{ estimation.tax|intcomma }}</i> 円</td>
                                                        <td><i id="estimate_total_with_tax">{{ estimation.total_with_tax|intcomma }}</i> 円</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered text-nowrap">
                                                <thead>
                                                    <tr>
                                                        <th>原価合計</th>
                                                        <th>税別粗利</th>
                                                        <th>粗利率</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td><i id="estimate_cost_total">{{ estimation.cost_total|intcomma }}</i> 円</td>
                                                        <td><i id="estimate_gross_profit">{{ estimation.gross_profit|intcomma }}</i> 円</td>
                                                        <td><i id="estimate_gross_profit_rate">{{ estimation.gross_profit_rate }}</i> %</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="table-responsive">
                                        <table class="table table-bordered text-nowrap" id="_estimation-content">
                                            <thead>
                                                <tr>
                                                    <th rowspan="2">名称</th>
                                                    <th rowspan="2">仕様</th>
                                                    <th>数量</th>
                                                    <th>単位</th>
                                                    <th>単価</th>
                                                    <th>金額</th>
                                                    <th>粗利</th>
                                                    <th rowspan="2">備考</th>
                                                    <th rowspan="2">削除</th>
                                                </tr>
                                                <tr>
                                                    <th>原価数量</th>
                                                    <th>原価単位</th>
                                                    <th>原価単価</th>
                                                    <th>原価金額</th>
                                                    <th>粗利率</th>
                                                </tr>
                                            </thead>
                                            {% for estimation_entry in estimation_entries %}
                                                <tbody class="_estimation-entry _estimation-entry{{ estimation_entry.id }}">
                                                    <tr>
                                                        <input type="hidden" name="entry_delete_flgs" value="false">
                                                        <input type="hidden" name="estimation_entry_ids" value="{{ estimation_entry.id }}">
                                                        <td rowspan="1" colspan="2"><input class="form-control" type="text" name="entry_names" value="{{ estimation_entry.name }}"></td>
                                                        <td>
                                                            <input class="form-control" type="number" name="entry_quantities" value="{{ estimation_entry.quantity }}">
                                                        </td>
                                                        <td>
                                                            <select class="form-control" name="entry_units" value="">
                                                            {% for unit in units %}
                                                                {% if unit.1 == estimation_entry.unit %}
                                                                    <option value="{{ unit.1 }}" selected>{{ unit.1 }}</option>
                                                                {% else %}
                                                                    <option value="{{ unit.1 }}">{{ unit.1 }}</option>
                                                                {% endif %}
                                                            {% endfor %}
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <input class="form-control" type="text" name="entry_prices" value="{{ estimation_entry.price }}">
                                                        </td>
                                                        <td><input class="form-control" type="text" disabled name="entry_totals" value="{{ estimation_entry.total }}"></td>
                                                        <td><input class="form-control" type="text" disabled name="entry_gross_profits" value="{{ estimation_entry.gross_profit }}"></td>
                                                        <td rowspan="2">
                                                            {% if estimation_entry.colored_flag %}
                                                                <textarea wrap="soft" placeholder="" name="entry_descriptions" style="color: red;">{{ estimation_entry.description|default_if_none:"" }}</textarea>
                                                            {% else %}
                                                                <textarea wrap="soft" placeholder="" name="entry_descriptions" style="color: black;">{{ estimation_entry.description|default_if_none:"" }}</textarea>
                                                            {% endif %}
                                                        </td>
                                                        <td><button type="button" class="btn btn-outline-warning btn-md _delete-entry-btn" value="{{ estimation_entry.id }}"><i class="sub-icon fas fa-trash-alt"></i>削除</button></td>
                                                    </tr>
                                                    <tr>
                                                        <td rowspan="1" colspan="2"><input type="button" class="btn btn-outline-warning btn-md _accordion-btn" value="-"></td>
                                                        <td>
                                                            <!-- <input class="form-control" type="text" disabled name="nominal_quantitys" value="{{ estimation_entry.nominal_quantity }}"> -->
                                                        </td>
                                                        <td>
                                                            <!-- <input class="form-control" type="text" disabled name="nominal_units" value="{{ estimation_entry.nominal_unit }}"> -->
                                                        </td>
                                                        <td>
                                                            <!-- <input class="form-control" type="text" disabled name="entry_costs" value="{{ estimation_entry.cost }}"> -->
                                                        </td>
                                                        <td><input class="form-control" type="text" disabled name="entry_cost_totals" value="{{ estimation_entry.cost_total }}"></td>
                                                        <td><input class="form-control" type="text" disabled name="entry_gross_profit_rates" value="{{ estimation_entry.gross_profit_rate }}"></td>
                                                        <td><button type="button" class="btn btn-outline-warning btn-md _estimate-colored-btn"><i class="sub-icon fas fa-pencil-alt"></i>色変更</button></td>
                                                        <input type="hidden" name="entry_colored_flgs" value="{{ estimation_entry.colored_flag }}">
                                                    </tr>
                                                </tbody>
                                                {% for estimation_entry_detail in estimation_entry_details %}
                                                  {% if estimation_entry_detail.estimation_entry_id == estimation_entry.id %}
                                                    <tbody class="_estimation-entry-detail _entry_id{{ estimation_entry.id }}">
                                                        <tr>
                                                            <input type="hidden" name="detail_delete_flgs" value="false">
                                                            <input type="hidden" name="entry_id_for_details" value="{{ estimation_entry.id }}">
                                                            <input type="hidden" name="entry_detail_ids" value="{{ estimation_entry_detail.id }}">
                                                            <td rowspan="2"><input class="form-control" type="text" name="detail_names" value="{{ estimation_entry_detail.name }}"></td>
                                                            <td rowspan="2"><input class="form-control" type="text" name="detail_project_types" value="{{ estimation_entry_detail.project_type }}"></td>
                                                            <td><input class="form-control _detail_quantities" type="number" name="detail_quantities" value="{{ estimation_entry_detail.quantity }}"></td>
                                                            <td>
                                                                <select class="form-control" name="detail_units" value="">
                                                                {% for unit in units %}
                                                                    {% if unit.1 == estimation_entry_detail.unit %}
                                                                        <option value="{{ unit.1 }}" selected>{{ unit.1 }}</option>
                                                                    {% else %}
                                                                        <option value="{{ unit.1 }}">{{ unit.1 }}</option>
                                                                    {% endif %}
                                                                {% endfor %}
                                                                </select>
                                                            </td>
                                                            <td><input class="form-control _detail_prices" type="number" name="detail_prices" value="{{ estimation_entry_detail.price }}"></td>
                                                            <td><input class="form-control _detail_totals" type="number" name="detail_totals" value="{{ estimation_entry_detail.total }}"></td>
                                                            <td><input class="form-control" type="number" disabled name="detail_gross_profits" value="{{ estimation_entry_detail.gross_profit }}"></td>
                                                            <td rowspan="2">
                                                                {% if estimation_entry_detail.colored_flag %}
                                                                    <textarea wrap="soft" placeholder="" name="detail_descriptions" style="color: red;">{{ estimation_entry_detail.description|default_if_none:"" }}</textarea>
                                                                {% else %}
                                                                    <textarea wrap="soft" placeholder="" name="detail_descriptions" style="color: black;">{{ estimation_entry_detail.description|default_if_none:"" }}</textarea>
                                                                {% endif %}
                                                            </td>
                                                            <td><button type="button" class="btn btn-outline-warning btn-md _delete-detail-btn"><i class="sub-icon fas fa-trash-alt"></i>削除</button></td>
                                                        </tr>
                                                        <tr>
                                                            <td><input class="form-control _detail_nominal_quantities" type="number" name="detail_nominal_quantities" value="{{ estimation_entry_detail.nominal_quantity }}"></td>
                                                            <td>
                                                                <select class="form-control" name="detail_nominal_units" value="">
                                                                {% for unit in units %}
                                                                    {% if unit.1 == estimation_entry_detail.nominal_unit %}
                                                                        <option value="{{ unit.1 }}" selected>{{ unit.1 }}</option>
                                                                    {% else %}
                                                                        <option value="{{ unit.1 }}">{{ unit.1 }}</option>
                                                                    {% endif %}
                                                                {% endfor %}
                                                                </select>
                                                            </td>
                                                            <td><input class="form-control _detail_costs" type="number" name="detail_costs" value="{{ estimation_entry_detail.cost }}"></td>
                                                            <td><input class="form-control _detail_cost_totals" type="number" name="detail_cost_totals" value="{{ estimation_entry_detail.cost_total }}"></td>
                                                            <td><input class="form-control" type="text" disabled name="detail_gross_profit_rates" value="{{ estimation_entry_detail.gross_profit_rate }}"></td>
                                                            <td><button type="button" class="btn btn-outline-warning btn-md _estimate-colored-btn"><i class="sub-icon fas fa-pencil-alt"></i>色変更</button></td>
                                                            <input type="hidden" name="detail_colored_flgs" value="{{ estimation_entry_detail.colored_flag }}">
                                                        </tr>
                                                    </tbody>
                                                  {% endif %}
                                                {% endfor %}
                                            {% endfor %}
                                        </table>
                                    </div>
                                    <div class="row">
                                      <div class="d-flex flex-row justify-content-end w-100">
                                          <button type="button" class="btn-back btn btn-outline-warning btn-md _estimate-mst-btn _estimation_template_search_btn"><i class="sub-icon fas fa-angle-double-left"></i>見積マスタ検索</button>
                                      </div>
                                    </div>
                                    <div id="_search-estimation-templates-modal" class="modal js-modal">
                                        <div class="modal__bg js-modal-close"></div>
                                        {% include "components/modal/search-estimation-templates-modal.html" %}
                                        <!--modal__inner-->
                                    </div><!--modal-->
                                </div>
                            </div>
                        </form>
                        <table>
                            <input type="hidden" id="_new_entry_id" value="0">
                            <tbody class="_estimation-entry _hidden_estimation-entry">
                                <tr>
                                    <input type="hidden" name="entry_delete_flgs" value="true">
                                    <input type="hidden" name="estimation_entry_ids" value="">
                                    <td rowspan="1" colspan="2"><input class="form-control" type="text" name="entry_names" value=""></td>
                                    <td><input class="form-control" type="number" name="entry_quantities" value=""></td>
                                    <td>
                                        <select class="form-control" name="entry_units" value="">
                                        {% for unit in units %}
                                            <option value="{{ unit.1 }}">{{ unit.1 }}</option>
                                        {% endfor %}
                                        </select>
                                    </td>
                                    <td><input class="form-control" type="text" name="entry_prices" value=""></td>
                                    <td><input class="form-control" type="text" disabled name="entry_totals" value=""></td>
                                    <td><input class="form-control" type="text" disabled name="entry_gross_profits" value=""></td>
                                    <td rowspan="2"><textarea wrap="soft" placeholder="" name="entry_descriptions" style="color: black;"></textarea></td>
                                    <td><button type="button" class="btn btn-outline-warning btn-md _delete-entry-btn" value=""><i class="sub-icon fas fa-trash-alt"></i>削除</button></td>
                                </tr>
                                <tr>
                                    <td rowspan="1" colspan="2"><input type="button" class="btn btn-outline-warning btn-md _accordion-btn" value="-"></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td><input class="form-control" type="text" disabled name="entry_cost_totals" value=""></td>
                                    <td><input class="form-control" type="text" disabled name="entry_gross_profit_rates" value=""></td>
                                    <td><button type="button" class="btn btn-outline-warning btn-md _estimate-colored-btn"><i class="sub-icon fas fa-pencil-alt"></i>色変更</button></td>
                                    <input type="hidden" name="entry_colored_flgs" value="0">
                                </tr>
                            </tbody>
                            <tbody class="_estimation-entry-detail _hidden_estimation-entry-detail">
                                <tr>
                                    <input type="hidden" name="detail_delete_flgs" value="true">
                                    <input type="hidden" name="entry_id_for_details" value="">
                                    <input type="hidden" name="entry_detail_ids" value="">
                                    <td rowspan="2"><input class="form-control" type="text" name="detail_names" value=""></td>
                                    <td rowspan="2"><input class="form-control" type="text" name="detail_project_types" value=""></td>
                                    <td><input class="form-control _detail_quantities" type="number" name="detail_quantities" value=""></td>
                                    <td>
                                        <select class="form-control" name="detail_units" value="">
                                        {% for unit in units %}
                                            <option value="{{ unit.1 }}">{{ unit.1 }}</option>
                                        {% endfor %}
                                        </select>
                                    </td>
                                    <td><input class="form-control _detail_prices" type="number" name="detail_prices" value=""></td>
                                    <td><input class="form-control _detail_totals" type="number" name="detail_totals" value=""></td>
                                    <td><input class="form-control" type="number" disabled name="detail_gross_profits" value=""></td>
                                    <td rowspan="2"><textarea wrap="soft" placeholder="" name="detail_descriptions" style="color: black;"></textarea></td>
                                    <td><button type="button" class="btn btn-outline-warning btn-md _delete-detail-btn"><i class="sub-icon fas fa-trash-alt"></i>削除</button></td>
                                </tr>
                                <tr>
                                    <td><input class="form-control _detail_nominal_quantities" type="number" name="detail_nominal_quantities" value=""></td>
                                    <td>
                                        <select class="form-control" name="detail_nominal_units" value="">
                                        {% for unit in units %}
                                            <option value="{{ unit.1 }}">{{ unit.1 }}</option>
                                        {% endfor %}
                                        </select>
                                    </td>
                                    <td><input class="form-control _detail_costs" type="number" name="detail_costs" value=""></td>
                                    <td><input class="form-control _detail_cost_totals" type="number" name="detail_cost_totals" value=""></td>
                                    <td><input class="form-control" type="text" disabled name="detail_gross_profit_rates" value=""></td>
                                    <td><button type="button" class="btn btn-outline-warning btn-md _estimate-colored-btn"><i class="sub-icon fas fa-pencil-alt"></i>色変更</button></td>
                                    <input type="hidden" name="detail_colored_flgs" value="0">
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
{% endblock %}
{% block script %}
    <script type="text/javascript" src="{% static 'js/common/string-util.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/common/validation.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/estimates/detail.js' %}"></script>
{% endblock %}
