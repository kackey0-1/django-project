{% extends "base.html" %}
{% load static %}
{% block title %}IDEAL_ASP{% endblock %}
{% block style %}<link rel="stylesheet" type="text/css" href="{% static 'css/partner_companies/index.css' %}">{% endblock %}
{% block content %}

<div id="sideBar_wrapper" class="sideBar">
    {% include "side-bar.html" %}
</div>
<div class="d-flex flex-row flex-wrap main-body">
    <main class="col-12">
        {% if save_message %}
            <div class="save-message alert-{{ alert_type }}" style="text-align: center;">
                {{ save_message }}
            </div>
        {% endif %}
        <form class="form_area" action="{% url 'partner_companies:index' %}" method="get">
        {% csrf_token %}
            <div class="fg form-inline">
            
                <input type="text" name="company_name" value="{{ parameter.company_name }}" class="form-control" placeholder="会社名">
            
                <div class="check_box form-inline">
                    {% if parameter.contractor_type == '1' %}
                    <label class="checkbox-inline"><input type="checkbox" name="contractor_type" value="1" checked>外注&nbsp; &nbsp;</label>
                    <label class="checkbox-inline"><input type="checkbox" name="contractor_type" value="2">仕入先</label>
                    
                    {% elif parameter.contractor_type == '2' %}
                    <label class="checkbox-inline"><input type="checkbox" name="contractor_type" value="1">外注&nbsp; &nbsp;</label>
                    <label class="checkbox-inline"><input type="checkbox" name="contractor_type" value="2" checked>仕入先</label>
                    
                    {% elif parameter.contractor_type == '0' %}
                    <label class="checkbox-inline"><input type="checkbox" name="contractor_type" value="1" checked>外注&nbsp; &nbsp;</label>
                    <label class="checkbox-inline"><input type="checkbox" name="contractor_type" value="2" checked>仕入先</label>
                    
                    {% else %}
                    <label class="checkbox-inline"><input type="checkbox" name="contractor_type" value="1">外注&nbsp; &nbsp;</label>
                    <label class="checkbox-inline"><input type="checkbox" name="contractor_type" value="2">仕入先</label>
                    {% endif %}
                </div>
                <select name="large_industry" class="SlectBox">
                    <option selected="selected" value="0">業種</option>
                    <option value="100"{% if parameter.large_industry == "100" %}selected{% endif %}>仕入れ</option>
                    <option value="200"{% if parameter.large_industry == "200" %}selected{% endif %}>一括</option>
                    <option value="300"{% if parameter.large_industry == "300" %}selected{% endif %}>内装仕上</option>
                    <option value="400"{% if parameter.large_industry == "400" %}selected{% endif %}>仮設・解体</option>
                    <option value="500"{% if parameter.large_industry == "500" %}selected{% endif %}>内装工事</option>
                    <option value="600"{% if parameter.large_industry == "600" %}selected{% endif %}>設備工事</option>
                    <option value="700"{% if parameter.large_industry == "700" %}selected{% endif %}>その他</option>
                </select>
            </div>
            <div name="error2" class="error2"></div>
            <div class="fg form-inline">
                <label class="sr-only">電話番号</label>
                <input type="text" name="company_tel" value="{{ parameter.company_tel }}" class="form-control" placeholder="電話番号">
                <label class="sr-only">住所</label>
                <input type="text" name="head_office_location" value="{{ parameter.head_office_location }}" class="form-control" placeholder="住所">
                <button type="submit" class="search_btn btn-outline-dark mb-2"><i class="sub-icon fas fa-search"></i>検索</button>
            </div>
            <div name="error3" class="error3"></div>
            
        </form>

        <form action="{% url 'partner_companies:choice_delete' %}" method="post">
            {% csrf_token %}
            
            <div class="wrapper_button">
                <a href="{% url 'partner_companies:create' %}">
                    <button type="button" class="btn btn-outline-warning btn-md"><i class="sub-icon fas fa-user-plus"></i>新規作成</button>
                </a>
                <button type="submit" class="btn-choice-delete btn btn-outline-warning btn-md"><i class="sub-icon fas fa-trash-alt"></i>選択消去</button>
                <!-- <a href="{% url 'partner_companies:ExportExcel' %}"> -->
                    <button type="submit" class="btn btn-outline-warning btn-md" formaction="{% url 'partner_companies:ExportExcel' %}
                    "><i class="sub-icon fas fa-download"></i>エクスポート</button>

                <!-- </a> -->
            </div>

            <div class="table-responsive" name="space">
                <table class="table table-striped text-nowrap">
                    <thead>
                        <tr>
                            <th>選択</th>
                            <th>業者コード</th>
                            <th>業者種別</th>
                            <th>会社名</th>
                            <th>業種</th>
                            <th>TEL</th>
                            <th>住所</th>
                            <th>支払いサイト</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for partner_company in partner_companies %}

                            <tr>
                                <input type="hidden" name="{{partner_company.id}}" value="{{partner_company.id}}">
                                <td>
                                    <input type="checkbox" name="partner_company_id[]" value="{{ partner_company.id }}">
                                </td>
                                <td>{{ partner_company.code|default:'' }}</td>
                                <td>{% if partner_company.contractor_type == '1' %}外注{% endif %}{% if partner_company.contractor_type == '2' %}仕入先{% endif %}{% if partner_company.contractor_type == '0' %}外注 仕入先{% endif %}</td>
                                <td>{{ partner_company.company_name }}</td>
                                <td>{{ partner_company.industry|default:'' }}</td>
                                <td>{{ partner_company.company_tel }}</td>
                                <td>{{ partner_company.head_office_location }}</td>
                                <td>{{ partner_company.payment_site }}</td>
                                <td>
                                    <a class="edit" href="{% url 'partner_companies:edit' partner_company.id %}">
                                        <button type="button" class="btn-edit btn_table btn-outline-dark btn-sm">編集</button>
                                    </a>
                                </td> 
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </form>
    </main>
</div>
{% endblock %}
{% block script %}<script type="text/javascript" src="{% static 'js/partner_companies/index.js' %}"></script>{% endblock %}